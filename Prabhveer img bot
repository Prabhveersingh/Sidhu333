import streamlit as st
import requests

# --- Page config ---
st.set_page_config(
    page_title="Text 2 Img by PS333",
    page_icon="ğŸ§ ",
    layout="centered"
)

# --- Header ---
st.image("https://i.ibb.co/5Wp2sxxn/1000319964-removebg-preview.png", width=250)
st.title("ğŸ”¥ PS333 Image Generator ğŸ”¥")

# --- Prompt Input ---
prompt = st.text_input("Enter your prompt", placeholder="E.g. A lion walking in a futuristic city")

# --- Style (optional, for display only) ---
style = st.selectbox("Select Image Style (for fun)", ["Realistic", "Anime", "Fantasy", "Cyberpunk", "Cartoon", "Photorealistic"])

# --- Generate Button ---
if st.button("âœ¨ Generate Image"):
    if prompt.strip() == "":
        st.warning("Please enter a valid prompt.")
    else:
        with st.spinner("â³ Generating your image..."):
            try:
                # One-click free API (Replicate proxy)
                response = requests.post(
                    "https://replicate-api-proxy.vyshnav.dev/sd",
                    json={"prompt": f"{style} style {prompt}"}
                )

                data = response.json()
                image_url = data.get("image_url")

                if image_url:
                    st.image(image_url, use_container_width=True, caption="Generated by à¨ªà©à¨°à¨­à¨µà©€à¨° à¨¸à¨¿à©°à¨˜ Ai")
                    st.success("âœ… Image created!")
                    st.markdown(f"ğŸ”— [Open Full Image]({image_url})")

                    # Download button
                    st.download_button(
                        label="ğŸ“¥ Download Image",
                        data=requests.get(image_url).content,
                        file_name="generated_image.png",
                        mime="image/png"
                    )
                else:
                    st.error("âŒ Failed to generate image.")
            except Exception as e:
                st.error(f"Something went wrong: {e}")

# --- Footer ---
st.markdown("---")
st.markdown(
    'ğŸ”§ Made with â¤ï¸ by [**PS333**](https://instagram.com/prabhveersingh01) | ğŸ”¥ Powered by **PS333 AI Studio**'
)
